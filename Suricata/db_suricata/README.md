# 🛢 DB Suricata 룰셋

이 디렉터리는 데이터베이스(DB) 서버에 대한 **비인가 접속 시도**를 탐지하기 위한  
Suricata 룰셋과 설정 파일을 포함합니다.

주요 탐지 대상은 **외부에서 MySQL(3306 포트)** 로 접속을 시도하는 행위입니다.

---

## 🔍 탐지 항목 설명

| 항목 | 설명 |
|------|------|
| **MySQL 접속 시도** | 외부에서 DB 서버의 3306 포트로 접속을 시도하는 트래픽을 탐지 |

---

## 🧪 테스트 시나리오 예시

> 아래는 Suricata 룰셋이 정상적으로 작동하는지 확인하기 위한 테스트 명령어입니다.  
> 테스트 전 DB 서버 IP와 사용자 정보를 실제 환경에 맞게 변경해 주세요.

---

### 🔹 MySQL 접속 시도

**목표:** 외부에서 DB 서버의 3306 포트로 MySQL 접속을 시도할 경우 탐지

```bash
mysql -h <DB_SERVER_IP> -P 3306 -u root -p
```

- `-h`: 접속 대상 DB 서버의 퍼블릭 IP
- `-P 3306`: MySQL 기본 포트
- `-u`, `-p`: 사용자명과 비밀번호 입력

**결과** : 접속 시도 시 Suricata의 `eve.json` 또는 `fast.log`에 로그가 기록되어야 합니다.

---

## 📄 참고

- 룰셋은 `rules/` 디렉터리 내에 저장되어 있으며, MySQL 접속 탐지를 위한 내용이 포함되어 있습니다.
- `suricata.yaml` 파일은 DB 서버 환경에서 Suricata가 해당 룰셋을 로딩하고 동작하도록 구성되어 있습니다.
- 탐지 결과는 기본적으로 `eve.json` 파일에 기록되며, `outputs:` 설정을 통해 로그 형식 및 저장 위치를 변경할 수 있습니다.
- 본 룰셋은 **퍼블릭 네트워크에 노출된 MySQL 서버**를 대상으로 테스트되었으며,  
  운영 환경 적용 시에는 반드시 **방화벽, 네트워크 ACL, Bastion Host 구성** 등과 함께 검토 후 적용하시기 바랍니다.
